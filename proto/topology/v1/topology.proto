// Copyright 2025 Author(s) of MCP Any
// SPDX-License-Identifier: Apache-2.0

edition = "2023";

option features.field_presence = IMPLICIT;

package topology.v1;

option go_package = "github.com/mcpany/core/proto/topology/v1";

// Graph represents the full network topology of the MCP ecosystem.
message Graph {
  // The list of connected clients.
  repeated Node clients = 1;
  // The core MCP Any server node.
  Node core = 2;
}

// Node represents a single entity in the topology graph.
message Node {
  // Unique identifier for the node.
  string id = 1;
  // Human-readable label for the node.
  string label = 2;
  // The type of the node.
  NodeType type = 3;
  // The operational status of the node.
  NodeStatus status = 4;
  // Additional metadata associated with the node.
  map<string, string> metadata = 5;
  // Child nodes contained within or connected to this node.
  repeated Node children = 6;
  // Performance metrics for the node.
  NodeMetrics metrics = 7;
}

// NodeType defines the category of a node.
enum NodeType {
  NODE_TYPE_UNSPECIFIED = 0;
  NODE_TYPE_CLIENT = 1;
  NODE_TYPE_CORE = 2;
  NODE_TYPE_SERVICE = 3;
  NODE_TYPE_TOOL = 4;
  NODE_TYPE_RESOURCE = 5;
  NODE_TYPE_PROMPT = 6;
  NODE_TYPE_API_CALL = 7;
  NODE_TYPE_MIDDLEWARE = 8;
  NODE_TYPE_WEBHOOK = 9;
}

// NodeStatus defines the operational state of a node.
enum NodeStatus {
  NODE_STATUS_UNSPECIFIED = 0;
  // The node is active and healthy.
  NODE_STATUS_ACTIVE = 1;
  // The node is inactive or disabled.
  NODE_STATUS_INACTIVE = 2;
  // The node is in an error state.
  NODE_STATUS_ERROR = 3;
}

// NodeMetrics encapsulates performance metrics for a node.
message NodeMetrics {
  // Queries per second.
  double qps = 1;
  // Average latency in milliseconds.
  double latency_ms = 2;
  // Error rate as a percentage (0.0 to 1.0).
  double error_rate = 3;
}
