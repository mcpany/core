// Copyright 2025 Author(s) of MCP Any
// SPDX-License-Identifier: Apache-2.0

package command

import (
	"context"
	"io"

	"github.com/docker/docker/api/types"
	"github.com/docker/docker/api/types/container"
	"github.com/docker/docker/api/types/image"
	"github.com/docker/docker/api/types/network"
	v1 "github.com/opencontainers/image-spec/specs-go/v1"
)

// DockerClient interface matching the subset of docker client methods used.
//
// Summary: interface matching the subset of docker client methods used.
type DockerClient interface {
	// ImagePull requests the docker host to pull an image from a remote registry.
	//
	// Summary: requests the docker host to pull an image from a remote registry.
	//
	// Parameters:
	//   - ctx: context.Context. The context for the operation.
	//   - ref: string. The string.
	//   - options: image.PullOptions. The options.
	//
	// Returns:
	//   - io.ReadCloser: The io.ReadCloser.
	//   - error: An error if the operation fails.
	//
	// Throws/Errors:
	//   Returns an error if the operation fails.
	ImagePull(ctx context.Context, ref string, options image.PullOptions) (io.ReadCloser, error)
	// ContainerCreate creates a new container based in the given configuration.
	//
	// Summary: creates a new container based in the given configuration.
	//
	// Parameters:
	//   - ctx: context.Context. The context for the operation.
	//   - config: *container.Config. The configuration.
	//   - hostConfig: *container.HostConfig. The host config.
	//   - networkingConfig: *network.NetworkingConfig. The networking config.
	//   - platform: *v1.Platform. The platform.
	//   - containerName: string. The string.
	//
	// Returns:
	//   - container.CreateResponse: The container.CreateResponse.
	//   - error: An error if the operation fails.
	//
	// Throws/Errors:
	//   Returns an error if the operation fails.
	ContainerCreate(ctx context.Context, config *container.Config, hostConfig *container.HostConfig, networkingConfig *network.NetworkingConfig, platform *v1.Platform, containerName string) (container.CreateResponse, error)
	// ContainerStart sends a request to the docker daemon to start a container.
	//
	// Summary: sends a request to the docker daemon to start a container.
	//
	// Parameters:
	//   - ctx: context.Context. The context for the operation.
	//   - containerID: string. The string.
	//   - options: container.StartOptions. The options.
	//
	// Returns:
	//   - error: An error if the operation fails.
	//
	// Throws/Errors:
	//   Returns an error if the operation fails.
	ContainerStart(ctx context.Context, containerID string, options container.StartOptions) error
	// ContainerRemove kills and removes a container from the docker host.
	//
	// Summary: kills and removes a container from the docker host.
	//
	// Parameters:
	//   - ctx: context.Context. The context for the operation.
	//   - containerID: string. The string.
	//   - options: container.RemoveOptions. The options.
	//
	// Returns:
	//   - error: An error if the operation fails.
	//
	// Throws/Errors:
	//   Returns an error if the operation fails.
	ContainerRemove(ctx context.Context, containerID string, options container.RemoveOptions) error
	// ContainerLogs returns the logs generated by a container in an io.ReadCloser.
	//
	// Summary: returns the logs generated by a container in an io.ReadCloser.
	//
	// Parameters:
	//   - ctx: context.Context. The context for the operation.
	//   - container: string. The string.
	//   - options: container.LogsOptions. The options.
	//
	// Returns:
	//   - io.ReadCloser: The io.ReadCloser.
	//   - error: An error if the operation fails.
	//
	// Throws/Errors:
	//   Returns an error if the operation fails.
	ContainerLogs(ctx context.Context, container string, options container.LogsOptions) (io.ReadCloser, error)
	// ContainerWait waits until the specified container is in a certain state.
	//
	// Summary: waits until the specified container is in a certain state.
	//
	// Parameters:
	//   - ctx: context.Context. The context for the operation.
	//   - containerID: string. The string.
	//   - condition: container.WaitCondition. The wait condition.
	//
	// Returns:
	//   - <-chan container.WaitResponse: The <-chan container.WaitResponse.
	//   - <-chan error: The <-chan error.
	ContainerWait(ctx context.Context, containerID string, condition container.WaitCondition) (<-chan container.WaitResponse, <-chan error)
	// ContainerAttach attaches to a container to read its output or write input.
	//
	// Summary: attaches to a container to read its output or write input.
	//
	// Parameters:
	//   - ctx: context.Context. The context for the operation.
	//   - container: string. The string.
	//   - options: container.AttachOptions. The options.
	//
	// Returns:
	//   - types.HijackedResponse: The types.HijackedResponse.
	//   - error: An error if the operation fails.
	//
	// Throws/Errors:
	//   Returns an error if the operation fails.
	ContainerAttach(ctx context.Context, container string, options container.AttachOptions) (types.HijackedResponse, error)
	// Close closes the client and releases any associated resources.
	//
	// Summary: closes the client and releases any associated resources.
	//
	// Parameters:
	//   None.
	//
	// Returns:
	//   - error: An error if the operation fails.
	//
	// Throws/Errors:
	//   Returns an error if the operation fails.
	Close() error
}
