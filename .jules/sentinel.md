## 2025-05-18 - [Secure CORS Wildcard Handling]
**Vulnerability:** The CORS middleware was configured to reflect the `Origin` header and set `Access-Control-Allow-Credentials: true` even when the allowed origin was set to `*`. This configuration, known as "Null Origin with Credentials" (or similar), effectively allows any site to make authenticated requests if the server supports credential-based auth, bypassing the security intention of wildcard origins.
**Learning:** Developers often misunderstand `Access-Control-Allow-Origin: *` and try to force credentials to work with it by reflecting the origin. This defeats the purpose of the browser's security check.
**Prevention:** When `*` is used as an allowed origin, the server must either set `Access-Control-Allow-Origin: *` and NOT set `Access-Control-Allow-Credentials`, OR it must validate the origin against a specific allowlist (not wildcard) if credentials are required. I implemented logic to distinguish between a wildcard match (resulting in public, non-credentialed access) and a specific match (allowing credentialed access).
